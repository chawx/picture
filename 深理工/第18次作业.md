# 第18次作业



```c
test_sorting(numbers, count, NULL);  // 传递NULL
test_sorting(numbers, count, (compare_cb)42);  // 传递一个随机数
```

![](https://raw.githubusercontent.com/chawx/picture/main/imageSnipaste_2023-12-01_16-35-43.png)



插入排序

```c
void insertion_sort(int *numbers, int count, compare_cb cmp)
{
    int i, j, key;

    for (i = 1; i < count; i++) {
        key = numbers[i];
        j = i - 1;

        while (j >= 0 && cmp(numbers[j], key) > 0) {
            numbers[j + 1] = numbers[j];
            j = j - 1;
        }

        numbers[j + 1] = key;
    }
}
```



###  修改`test_sorting`：

```c
codevoid test_sorting(int *numbers, int count, compare_cb cmp, const char *algorithm_name)
{
    printf("Sorting using %s algorithm:\n", algorithm_name);
    int *sorted = bubble_sort(numbers, count, cmp);  // 或者使用 insertion_sort

    if(!sorted) die("Failed to sort as requested.");

    for(int i = 0; i < count; i++) {
        printf("%d ", sorted[i]);
    }
    printf("\n");

    free(sorted);
}
```

### 8. 在`main`中测试两种排序算法：

```c
codeint main(int argc, char *argv[])
{
    if(argc < 2) die("USAGE: ex18 4 3 1 5 6");

    int count = argc - 1;
    int i = 0;
    char **inputs = argv + 1;

    int *numbers = malloc(count * sizeof(int));
    if(!numbers) die("Memory error.");

    for(i = 0; i < count; i++) {
        numbers[i] = atoi(inputs[i]);
    }

    test_sorting(numbers, count, sorted_order, "Bubble Sort");
    test_sorting(numbers, count, insertion_sort, "Insertion Sort");

    free(numbers);

    return 0;
}
```

